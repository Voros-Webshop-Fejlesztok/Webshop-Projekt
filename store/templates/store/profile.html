{% extends 'store/main.html' %}
{% load static %}
{% block content %}
{% load humanize %}

<body className='snippet-body'>
    <div class="container mt-5">
        <div class="row d-flex justify-content-center">
            <div class="col-md-7">
                <div class="card p-3 py-4">
                    <div class="text-center">
                        <img src="{{profile.imageURL}}" class="rounded-circle profile_img">
                    </div>
                    <div class="text-center mt-3">
                        <form method=POST>
                        {% csrf_token %}
                            {% if profile != self_profile %}
                            {% if profile in self_profile.follows.all %}
                            <div>
                                <span class="bg-success p-1 px-4 rounded text-white">Követed ;D</span>
                                <button name="follow" value="unfollow;{{profile}}" type="submit" class="bx bx-user-minus unfollow_btn big_btn"></button>
                            </div>
                            {% else %}
                            <div>
                                <span class="bg-danger p-1 px-4 rounded text-white">Nem követed</span>
                                <button name="follow" value="follow;{{profile}}" type="submit" class="bx bx-user-plus follow_btn big_btn"></button>
                            </div>
                            {% endif %}   
                            {% endif %}
                        </form>
                        <h4 class="mt-2 mb-0">{{profile.name}}</h4>
                        <div class="block" style="margin-bottom: 20px;">
                            {% if profile.email != None %}
                            <span class="span">{{profile.email}}</span>
                            {% endif %}
                            {% if profile.phone_number != None %}
                            <span class="span">{{profile.phone_number}}</span>
                            {% endif %}
                        </div>
                        <div class="block description">
                            {% if profile.description != None %}
                            <span class="span">{{profile.description}}</span>
                            {% endif %}
                        </div>
                        <div class="sor">
                            <div class="div1">
                                <h5 class="mt-2 mb-0">Követők:</h5>
                                <div class="block">
                                    <img src="" width="30" class="rounded-circle"><span class="span">1. Követő neve</span>
                                </div>
                            </div>
                        
                            <div class="div2">
                                <h5 class="mt-2 mb-0">Követések:</h5>
                                <form method=POST>
                                    {% csrf_token %}
                                    
                                    {% for following in profile.follows.all %}
                                    {% if following != self_profile %}
                                    
                                    <div style="margin-top: 15px;"><a class="follower_a" href=" {% url 'profile' following.user.id %}">
                                        <img src="{{following.imageURL}}" class="rounded-circle follower_img">
                                        <span class="span follower_a">{{following}}</span></a>

                                        {% if following in self_profile.follows.all %}
                                        <button name="follow" value="unfollow;{{following}}" type="submit" class="bx bx-user-minus unfollow_btn"></button>
                                        {% else %}
                                        <button name="follow" value="follow;{{following}}" type="submit" class="bx bx-user-plus follow_btn"></button>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                    {% endfor %} 

                                </form>
                                </div>
                            </div>
                        </div>
                    </div> 
                </div>  
            </div> 
        </div>
    </div>
    {% if profile == self_profile %}
    <div class="container mt-5">
        <div class="row d-flex justify-content-center">
            <div class="col-md-7">
                <div class="card p-3 py-4"> 
                    <div class="text-center mt-3">
                        <h3 class="mt-2 mb-0">Rendeléseim:</h3>
                        {% for order in orders %}
                        <div class="sor">
                            <div class="div2">
                                <h4 style="text-decoration: underline;" class="mt-2 mb-0">{{order}}</h4> 
                                <h5 class="mt-2 mb-0">{{order.get_cart_total|intcomma}} Ft</h5> 
                            </div>
                            <div class="div1">
                            {% for order_item in order_items %}
                                {% if order.id == order_item.order_id %} 
                                    {% for product in products %}
                                        {% if product.id == order_item.product_id %}
                                            <img class="orderphoto" src="{{product.imageURL}}" class="rounded-circle">
                                            <h6 class="fonts">{{order_item.quantity}} db - {{order_item.product}}</h6>
                                            <h6 class="fonts">{{product.price|intcomma}} Ft</h6>
                                        {% endif %}
                                    {% endfor %}
                                {% endif %}
                            {% endfor %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
    <div class="container mt-5">
        <div class="row d-flex justify-content-center">
            <div class="col-md-7">
                <div class="card p-3 py-4"> 
                    <div class="text-center mt-3">
                        <h4 class="mt-2 mb-0">Posztjaim:</h4>
                        <div>
                            <img class="orderphoto" src="" width="400" class="rounded-circle">
                        </div>
                        <div>
                            <h4 class="mt-2 mb-0">Poszt címe</h4>
                            <p class="fonts">A poszt hosszabb leírása. </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>

{% endblock content %}
